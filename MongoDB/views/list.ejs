<%- include('partials/header') %>
<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h3>BREAD(Browse, Read, Edit, Add, Delete)</h3>
      <h4>Filters</h4>
    </div>

    <div class="card-body">
      <form action="" method="get">
        <input type="hidden" name="page" value="1" />
        <input type="hidden" name="sortBy" value="id" />
        <input type="hidden" name="sortMode" value="asc" />
        <div class="row mb-3">
          <label for="id" class="col-sm-2 col-form-label"
            ><input type="checkbox" name="idcheck" id="id"
            <%=query.idcheck=='on' ? 'checked' : '' %>/> ID</label
          >
          <div class="col-sm-10">
            <input
              type="text"
              class="form-control"
              id="id"
              name="id"
              placeholder="ID"
              value="<%= query.id %>"
            />
          </div>
        </div>

        <div class="row mb-3">
          <label for="string" class="col-sm-2 col-form-label"
            ><input type="checkbox" name="stringcheck" id="string"
            <%=query.stringcheck=='on' ? 'checked' : '' %>/> String</label
          >
          <div class="col-sm-10">
            <input
              type="text"
              class="form-control"
              id="string"
              name="string"
              placeholder="String"
              value="<%= query.string %>"
            />
          </div>
        </div>

        <div class="row mb-3">
          <label for="integer" class="col-sm-2 col-form-label"
            ><input type="checkbox" name="integercheck" id="integer"
            <%=query.integercheck=='on' ? 'checked' : '' %> /> Integer</label
          >
          <div class="col-sm-10">
            <input
              type="text"
              class="form-control"
              id="integer"
              name="integer"
              placeholder="Integer"
              value="<%= query.integer %>"
            />
          </div>
        </div>

        <div class="row mb-3">
          <label for="float" class="col-sm-2 col-form-label"
            ><input type="checkbox" name="floatcheck" id="float"
            <%=query.floatcheck=='on' ? 'checked' : '' %> /> Float</label
          >
          <div class="col-sm-10">
            <input
              type="text"
              class="form-control"
              id="float"
              name="float"
              placeholder="Float"
              value="<%= query.float %>"
            />
          </div>
        </div>

        <div class="row mb-1">
          <label for="date" class="col-sm-2 col-form-label"
            ><input type="checkbox" name="datecheck" id="date"
            <%=query.datecheck=='on' ? 'checked' : '' %> /> Date</label
          >
          <div class="col-sm-3">
            <input
              type="date"
              class="form-control"
              id="date"
              name="startdate"
              placeholder="Start Date"
              value="<%= query.startdate %>"
            />
          </div>
        </div>

        <div class="row mb-3">
          <label for="date" class="col-sm-2 col-form-label"></label>
          <div class="col-sm-3">
            <label class="col mb-1">to</label>
            <input
              type="date"
              class="form-control"
              id="date"
              name="enddate"
              placeholder="End Date"
              value="<%= query.enddate %>"
            />
          </div>
        </div>

        <div class="row mb-3">
          <label for="boolean" class="col-sm-2 col-form-label"
            ><input type="checkbox" name="booleancheck" id="boolean"
            <%=query.booleancheck=='on' ? 'checked' : '' %> /> Boolean</label
          >
          <div class="col-sm-10">
            <select name="boolean" class="form-select" id="boolean">
              <option value="" selected disabled>Choose the boolean ...</option>
              <option value="true">True</option>
              <option value="false">False</option>
            </select>
          </div>
        </div>

        <button type="submit" class="btn btn-primary">
          <i class="fa-solid fa-magnifying-glass"></i> Search
        </button>
        <a href="/" class="btn btn-warning"
          ><i class="fa-solid fa-window-restore"></i> Reset</a
        >
      </form>

      <table class="table table-striped table-hover">
        <thead>
          <tr>
            
            <th>
              <a
                style="text-decoration: none; color: #000"
                href="<%= url.replace(`sortBy=${query.sortBy}`,`sortBy=_id`).replace(`sortMode=${query.sortMode}`,`sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`) %>"
              >
                No &nbsp;<i
                  class="fa-solid fa-<%= query.sortBy == '_id' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort' %>"
                ></i>
              </a>
            </th>

            <th>
              <a style="text-decoration: none; color: #000;" href="<%= url.replace(`sortBy=${query.sortBy}`,`sortBy=string`).replace(`sortMode=${query.sortMode}`,`sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`) %>">
                String &nbsp;<i class="fa-solid fa-<%= query.sortBy == 'string' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort' %>"></i>
            </a>
            </th>

            <th>
              <a style="text-decoration: none; color: #000;" href="<%= url.replace(`sortBy=${query.sortBy}`,`sortBy=integer`).replace(`sortMode=${query.sortMode}`,`sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`) %>">
                Integer &nbsp;<i class="fa-solid fa-<%= query.sortBy == 'integer' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort' %>"></i>
            </a>
            </th>

            <th>
              <a style="text-decoration: none; color: #000;" href="<%= url.replace(`sortBy=${query.sortBy}`,`sortBy=float`).replace(`sortMode=${query.sortMode}`,`sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`) %>">
                Float &nbsp;<i class="fa-solid fa-<%= query.sortBy == 'float' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort' %>"></i>
            </a>
            </th>

            <th>
              <a style="text-decoration: none; color: #000;" href="<%= url.replace(`sortBy=${query.sortBy}`,`sortBy=float`).replace(`sortMode=${query.sortMode}`,`sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`) %>">
                Date &nbsp;<i class="fa-solid fa-<%= query.sortBy == 'float' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort' %>"></i>
            </a>
            </th>

            <th>
              <a style="text-decoration: none; color: #000;" href="<%= url.replace(`sortBy=${query.sortBy}`,`sortBy=boolean`).replace(`sortMode=${query.sortMode}`,`sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`) %>">
                Boolean &nbsp;<i class="fa-solid fa-<%= query.sortBy == 'boolean' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort' %>"></i>
            </a>
            </th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% data.forEach((item, index) => { %>
          <tr>
            <td><%= index + 1 + offset %></td>
            <td><%= item.string %></td>
            <td><%= item.integer %></td>
            <td><%= item.float %></td>
            <td><%= moment(item.date).format('DD MMMM YYYY') %></td>
            <td><%= item.boolean %></td>
            <td>
              <a href="/edit/<%= item._id %>" class="btn btn-success"
                ><i class="fa-solid fa-pen-to-square"></i> Edit</a
              >
              <a
                href="/delete/<%= item._id %>"
                onclick="return confirm('Are you sure you wanna delete this ?')"
                class="btn btn-danger"
                ><i class="fa-solid fa-trash"></i> Delete</a
              >
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>

      <nav aria-label="Page navigation example">
        <ul class="pagination">
          <li class="page-item">
            <%if(page != 1) {%>
            <a
              class="page-link"
              href="<%= url.replace(`page=${page}`,`page=${Number(page)-1}`) %>"
              >Previous</a
            >
            <% } %>
          </li>
          <% for(let i = 1 ; i <= pages; i++){ %>
          <li class="page-item <%= i == page ? ' active ' : '' %>">
            <a
              class="page-link"
              href="<%= url.replace(`page=${page}`,`page=${i}`) %>"
              ><%= i%></a
            >
          </li>
          <% } %>
          <li class="page-item">
            <%if(page <= pages && page != pages) {%>
            <a
              class="page-link"
              href="<%= url.replace(`page=${page}`,`page=${Number(page)+1}`) %>"
              >Next</a
            >
            <% } %>
          </li>
        </ul>
      </nav>

      <a href="/add" class="btn btn-primary"
        ><i class="fa-solid fa-plus"></i> Add</a
      >
    </div>
  </div>
</div>

<%- include('partials/footer') %>
